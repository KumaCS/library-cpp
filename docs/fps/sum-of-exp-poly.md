多項式 $f$ について以下の値を計算する．

- $\sum_{i=0}^{n-1}r^if(i)$
- $\sum_{i=0}^{\infty}r^if(i),\quad|r|\lt 1$
  - 有理数として $|r|\lt 1$ を満たすものが modint で与えられる

$d=\deg f$ とし，$f(0),\dots,f(d)$ が与えられるものとする．

## 仕組み

$r=0$ は自明．

$r=1$ のとき単に Lagrange 補間すればよい．

以下 $r\neq 0,1$ とする．

数列 $\{r^if(i)\}$ は $\dfrac{p(x)}{(1-rx)^{d+1}}$ の形の母関数をもつ．

従って $a_i=\sum_{i=0}^{n-1}r^if(i)$ とすれば $\{a_i\}$ の母関数は
$$\frac{xp(x)}{(1-rx)^{d+1}(1-x)}=\frac{q(x)}{(1-rx)^{d+1}}+\frac{c}{1-x}$$
と部分分数分解できる．
$q(x)$ は高々 $d$ 次であるから，両辺に $(1-rx)^{d+1}$ を掛けて $x^{d+1}$ の係数を考えれば次のように $c$ が求められる．
$$c=(1-r)^{-(d+1)}\sum_{i=0}^{d+1}\binom{d+1}{i}(-r)^{d+1-i}a_i$$

また $\frac{q(x)}{(1-rx)^{d+1}}$ は $\{a_i-c\}$ の母関数であるが，この母関数から得られる数列は $r$ の冪と多項式の和の形であるから Lagrange 補間で求められる．

無限和のとき $\{a_i-c\}$ は $0$ に収束するので求める値は単に $c$ である．