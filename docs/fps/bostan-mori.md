Bostan-Mori 法．

高々 $m$ 次のFPS $f,g$ に対し $[x^n]\frac{f(x)}{g(x)}$ を $O(m\log m\log n)$ 時間で求める．

## アルゴリズム

以下の変形をする．

$$\frac{f(x)}{g(x)}=\frac{f(x)g(-x)}{g(x)g(-x)}$$

$g(x)g(-x)$ は偶関数であるから $g(x)g(-x)=g'(x^2)$ とおける．

$n$ が偶数のとき，$f(x)g(-x)$ の偶数次の部分を $f'(x^2)$ とすれば以下が成り立つ．

$$[x^n]\frac{f(x)}{g(x)}=[x^n]\frac{f'(x^2)}{g'(x^2)}=[x^{n/2}]\frac{f'(x)}{g'(x)}$$

$n$ が奇数のときも同様．

## 定数倍高速化

$\max(\deg f,\deg g)+1$ 以上の最小の二冪を $m$ とし，$1$ の原始 $2m$ 乗根 $\omega$ をとる．

$g'(\omega^{2i})=g(\omega^i)g(\omega^{i+m})$ であるので，$g$ に長さ $2m$ の FFT をし，適当に積を取って長さ $m$ の IFTT をすれば $g'$ が求められる．

また FFT のダブリングを用いればさらに定数倍が改善できる．